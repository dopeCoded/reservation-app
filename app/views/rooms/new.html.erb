<div class="container">
  <div class="row justify-content-center">
    <div class="col-md-6">
      <%= form_for(@room, html: { class: 'form-group' }) do |f| %>
        <div class="mb-3">
          <%= f.label :name, class: 'form-label' %>
          <%= f.text_field :name, class: 'form-control' %>
        </div>

        <div class="mb-3">
          <%= f.label :description, class: 'form-label' %>
          <%= f.text_area :description, class: 'form-control' %>
        </div>

        <div class="mb-3">
          <%= f.label :price, class: 'form-label' %>
          <%= f.number_field :price, class: 'form-control' %>
        </div>

        <div class="mb-3">
          <%= f.label :address, class: 'form-label' %>
          <%= f.text_field :address, class: 'form-control' %>
        </div>

        <div class="mb-3">
          <%= f.label :area %>
          <%= f.select :area, ["Tokyo", "Osaka", "Kyoto", "Sapporo"], prompt: "Select an area" %>
        </div>
        
        <div class="mb-3">
          <%= f.label :image, class: 'form-label' %>
          <%= f.file_field :image, class: 'form-control', id: 'room_image' %>
        </div>

        <%= f.submit "Create Room", class: 'btn btn-primary' %>
      <% end %>

      <div class="mt-3">
        <img id="img" accept="image/*" src="https://rails-02-sample.herokuapp.com/assets/common/default-avatar-7a6cbfd7993e89f24bfc888f4a035a83c6f1428b8bdc47eed9095f2799a40153.png" style="display: none;">
      </div>
    </div>
  </div>
</div>

<% if @room.image.attached? %>
  <div class="mt-3">
    <%= image_tag(@room.image.variant(resize: "500x500"), class: 'img-fluid') %>
  </div>
<% end %>

<div class="mt-3">
  <%= link_to 'Back', @user, class: 'btn btn-secondary' %>
</div>

<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script>
$(document).on('turbolinks:load', function() {
  $('#room_image').on('change', function (e) {
      var reader = new FileReader();
      reader.onload = function (e) {
          $("#img").attr('src', e.target.result);
          $("#img").css('display', '');
      }
      reader.readAsDataURL(e.target.files[0]);
  });

  // 削除ボタンクリック時にフォームとプレビューを初期化
  $('#delete').on('click', function (e) {
    $("#img").attr('src', '');
    $("#form").val('');
  });
});
</script>